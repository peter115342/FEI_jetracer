"use strict";(self.webpackChunkfei_jetracer_docs=self.webpackChunkfei_jetracer_docs||[]).push([[159],{4015:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"FEIcar/object_detection","title":"Object Detection with OpenCV and CUDA","description":"This tutorial covers setting up object detection capabilities on your FEI JetRacer using OpenCV with CUDA acceleration and YOLOv4-Tiny for real-time performance.","source":"@site/docs/FEIcar/object_detection.md","sourceDirName":"FEIcar","slug":"/FEIcar/object_detection","permalink":"/FEI_jetracer/docs/FEIcar/object_detection","draft":false,"unlisted":false,"editUrl":"https://github.com/peter115342/FEI_jetracer/tree/main/fei-jetracer-docs/docs/FEIcar/object_detection.md","tags":[],"version":"current","sidebarPosition":9,"frontMatter":{"sidebar_position":9},"sidebar":"tutorialSidebar","previous":{"title":"FEI DonkeyCar Installation on Jetson Nano","permalink":"/FEI_jetracer/docs/FEIcar/FEIcar_installation"}}');var l=s(4848),r=s(8453);const t={sidebar_position:9},a="Object Detection with OpenCV and CUDA",c={},o=[{value:"Overview",id:"overview",level:2},{value:"Manual Installation",id:"manual-installation",level:2},{value:"Step 1: Install OpenCV with CUDA Support",id:"step-1-install-opencv-with-cuda-support",level:3},{value:"Download the Installation Script",id:"download-the-installation-script",level:4},{value:"Prepare Your System",id:"prepare-your-system",level:4},{value:"Run the Installation Script",id:"run-the-installation-script",level:4},{value:"Verify Installation",id:"verify-installation",level:4},{value:"Step 2: Configure Environment",id:"step-2-configure-environment",level:3},{value:"Step 3: Setup YOLOv4-Tiny",id:"step-3-setup-yolov4-tiny",level:2},{value:"Create Models Directory",id:"create-models-directory",level:3},{value:"Download YOLOv4-Tiny Files",id:"download-yolov4-tiny-files",level:3},{value:"Verify Model Files",id:"verify-model-files",level:3},{value:"Test Object Detection",id:"test-object-detection",level:3},{value:"Performance Tips",id:"performance-tips",level:2},{value:"Optimize for Real-time Performance",id:"optimize-for-real-time-performance",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"OpenCV Installation Issues",id:"opencv-installation-issues",level:3},{value:"CUDA Not Working",id:"cuda-not-working",level:3},{value:"Model Loading Errors",id:"model-loading-errors",level:3},{value:"References",id:"references",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"object-detection-with-opencv-and-cuda",children:"Object Detection with OpenCV and CUDA"})}),"\n",(0,l.jsx)(n.p,{children:"This tutorial covers setting up object detection capabilities on your FEI JetRacer using OpenCV with CUDA acceleration and YOLOv4-Tiny for real-time performance."}),"\n",(0,l.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,l.jsx)(n.p,{children:"We'll use:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"OpenCV with CUDA"}),": For accelerated computer vision operations"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"YOLOv4-Tiny"}),": A lightweight object detection model optimized for embedded devices"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"cuDNN"}),": NVIDIA's deep learning acceleration library"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"manual-installation",children:"Manual Installation"}),"\n",(0,l.jsx)(n.h3,{id:"step-1-install-opencv-with-cuda-support",children:"Step 1: Install OpenCV with CUDA Support"}),"\n",(0,l.jsx)(n.p,{children:"We'll use the Qengineering installation script which automates the complex process of building OpenCV with CUDA and cuDNN support."}),"\n",(0,l.jsx)(n.h4,{id:"download-the-installation-script",children:"Download the Installation Script"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"cd ~\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/Qengineering/Install-OpenCV-Jetson-Nano.git\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"cd Install-OpenCV-Jetson-Nano\n"})}),"\n",(0,l.jsx)(n.h4,{id:"prepare-your-system",children:"Prepare Your System"}),"\n",(0,l.jsx)(n.p,{children:"Before running the installation script, ensure your system is ready:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"sudo apt update && sudo apt upgrade -y\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"sudo apt autoremove -y\n"})}),"\n",(0,l.jsx)(n.p,{children:"Free up disk space and increase swap:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"sudo systemctl disable nvzramconfig\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"sudo fallocate -l 4G /var/swapfile\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"sudo chmod 600 /var/swapfile\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"sudo mkswap /var/swapfile\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"sudo swapon /var/swapfile\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"sudo swapon -s\n"})}),"\n",(0,l.jsx)(n.h4,{id:"run-the-installation-script",children:"Run the Installation Script"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Warning"}),": This process can take 2-4 hours to complete. Ensure stable power supply and don't interrupt the process."]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"chmod +x ./OpenCV-4-11-0.sh\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"./OpenCV-4-11-0.sh\n"})}),"\n",(0,l.jsx)(n.p,{children:"The script will:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Install all necessary dependencies"}),"\n",(0,l.jsx)(n.li,{children:"Download OpenCV source code"}),"\n",(0,l.jsx)(n.li,{children:"Configure build with CUDA support"}),"\n",(0,l.jsx)(n.li,{children:"Compile OpenCV (this takes the longest time)"}),"\n",(0,l.jsx)(n.li,{children:"Install the compiled libraries"}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"verify-installation",children:"Verify Installation"}),"\n",(0,l.jsx)(n.p,{children:"After installation completes, verify OpenCV with CUDA support:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"python3 -c \"import cv2; print('OpenCV version:', cv2.__version__); print('CUDA devices:', cv2.cuda.getCudaEnabledDeviceCount())\"\n"})}),"\n",(0,l.jsx)(n.p,{children:"You should see output similar to:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"OpenCV version: 4.11.1\nCUDA devices: 1\n"})}),"\n",(0,l.jsx)(n.h3,{id:"step-2-configure-environment",children:"Step 2: Configure Environment"}),"\n",(0,l.jsx)(n.p,{children:"Ensure the OpenCV installation is properly configured in your DonkeyCar environment:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"source ~/env/bin/activate\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"cd ~/mycar\n"})}),"\n",(0,l.jsx)(n.p,{children:"Test OpenCV in your virtual environment:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"python3 -c \"import cv2; print('OpenCV loaded successfully with version:', cv2.__version__)\"\n"})}),"\n",(0,l.jsx)(n.h2,{id:"step-3-setup-yolov4-tiny",children:"Step 3: Setup YOLOv4-Tiny"}),"\n",(0,l.jsx)(n.p,{children:"Now we'll add YOLOv4-Tiny object detection model to your DonkeyCar setup."}),"\n",(0,l.jsx)(n.h3,{id:"create-models-directory",children:"Create Models Directory"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"cd ~/mycar\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"mkdir -p models\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"cd models\n"})}),"\n",(0,l.jsx)(n.h3,{id:"download-yolov4-tiny-files",children:"Download YOLOv4-Tiny Files"}),"\n",(0,l.jsx)(n.p,{children:"Download the pre-trained YOLOv4-Tiny model files:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"wget https://github.com/AlexeyAB/darknet/releases/download/darknet_yolo_v3_optimal/yolov4-tiny.weights\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"wget https://raw.githubusercontent.com/AlexeyAB/darknet/master/cfg/yolov4-tiny.cfg\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"wget https://raw.githubusercontent.com/AlexeyAB/darknet/master/data/coco.names\n"})}),"\n",(0,l.jsx)(n.h3,{id:"verify-model-files",children:"Verify Model Files"}),"\n",(0,l.jsx)(n.p,{children:"Check that all required files are present:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"ls -la ~/mycar/models/\n"})}),"\n",(0,l.jsx)(n.p,{children:"You should see:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"yolov4-tiny.weights"})," (approximately 23MB)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"yolov4-tiny.cfg"})," (configuration file)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"coco.names"})," (class labels file)"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"test-object-detection",children:"Test Object Detection"}),"\n",(0,l.jsx)(n.p,{children:"Test by running the DonkeyCar web interface:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"cd ~/mycar\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"python manage.py drive\n"})}),"\n",(0,l.jsx)(n.p,{children:"You should see the object detection in the camera feed in the web interface."}),"\n",(0,l.jsx)(n.h2,{id:"performance-tips",children:"Performance Tips"}),"\n",(0,l.jsx)(n.h3,{id:"optimize-for-real-time-performance",children:"Optimize for Real-time Performance"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Resolution Tuning"}),": Balance between accuracy and speed by adjusting input resolution"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Detection Frequency"}),": Run detection every few frames rather than every frame"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"ROI Processing"}),": Only process regions of interest in the image"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,l.jsx)(n.h3,{id:"opencv-installation-issues",children:"OpenCV Installation Issues"}),"\n",(0,l.jsx)(n.p,{children:"If the installation script fails:"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Insufficient storage"}),": Ensure at least 16GB free space"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Memory issues"}),": Increase swap file size"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Power issues"}),": Use adequate power supply"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"cuda-not-working",children:"CUDA Not Working"}),"\n",(0,l.jsx)(n.p,{children:"If CUDA acceleration isn't working:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Check CUDA installation\nnvcc --version\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Verify cuDNN\ncat /usr/local/cuda/include/cudnn_version.h | grep CUDNN_MAJOR -A 2\n"})}),"\n",(0,l.jsx)(n.h3,{id:"model-loading-errors",children:"Model Loading Errors"}),"\n",(0,l.jsx)(n.p,{children:"If YOLO models fail to load:"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Verify file integrity:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"md5sum ~/mycar/models/yolov4-tiny.weights\n"})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Check file permissions:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"chmod 644 ~/mycar/models/*\n"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/Qengineering/Install-OpenCV-Jetson-Nano",children:"Qengineering OpenCV Installation Script"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://arxiv.org/abs/2004.10934",children:"YOLOv4-Tiny Paper"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://docs.opencv.org/master/d2/d58/tutorial_table_of_content_dnn.html",children:"OpenCV DNN Module Documentation"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://developer.nvidia.com/embedded/jetson-nano-developer-kit",children:"NVIDIA Jetson Nano Developer Kit"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>a});var i=s(6540);const l={},r=i.createContext(l);function t(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);